# üîê –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —É–¥–æ–±—Å—Ç–≤–∞.

## üéØ –¢—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è

### 1. üîë –°–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—Ç. –î–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å.

**API Endpoint:**
```
POST /api/auth/password-reset/verify-security/
{
  "email": "user@example.com",
  "security_answer": "–º–æ–π –æ—Ç–≤–µ—Ç",
  "new_password": "newpassword123",
  "new_password_confirm": "newpassword123"
}
```

### 2. ‚è∞ –í—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ (15 –º–∏–Ω—É—Ç)
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞. –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 15 –º–∏–Ω—É—Ç.

**–®–∞–≥ 1: –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∫–æ–¥**
```
POST /api/auth/password-reset/request/
{
  "email": "user@example.com"
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "message": "–ö–æ–¥ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è —Å–æ–∑–¥–∞–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞.",
  "security_question": "–ö–∞–∫ –∑–æ–≤—É—Ç –≤–∞—à–µ–≥–æ –ø–µ—Ä–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞?"
}
```

**–ö–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–∫–∞–∂–µ—Ç:**
```
============================================================
üîë PASSWORD RESET CODE
üìß Email: user@example.com
üîê Code: ABC12XYZ
‚è∞ Expires: 2026-01-05 21:30:15
============================================================
```

**–®–∞–≥ 2: –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å —Å –∫–æ–¥–æ–º**
```
POST /api/auth/password-reset/verify-code/
{
  "email": "user@example.com",
  "reset_code": "ABC12XYZ",
  "new_password": "newpassword123",
  "new_password_confirm": "newpassword123"
}
```

### 3. üë®‚Äçüíº –ê–¥–º–∏–Ω—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç (Helpdesk)
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞—Ç–∏–ª—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

**–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞:**
```bash
cd "/home/alexander/web/Final Project"
source venv/bin/activate
python reset_password.py
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:**
```
============================================================
üîê ADMIN: Password Reset Tool
============================================================
This tool simulates a helpdesk password reset.
In production, verify user identity before resetting!

============================================================
üìã All Users in System:
============================================================
1. user@example.com
   Name: John Doe
   Created: 2026-01-04
   Active: ‚úì

Enter user email to reset password: user@example.com

‚úì Found user: user@example.com
  Name: John Doe
  Registered: 2026-01-04 15:30:00

‚ö†Ô∏è  Reset password for user@example.com? (yes/no): yes

Enter new password (min 8 characters): newpassword123
Confirm new password: newpassword123

============================================================
‚úÖ Password successfully reset for user@example.com
============================================================

üìß Email: user@example.com
üîë New password: newpassword123

‚ÑπÔ∏è  User can now login with the new password.
‚ÑπÔ∏è  Advise user to change password after logging in.
============================================================
```

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª—å User (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
```python
class User(Document):
    email = EmailField(required=True, unique=True)
    password_hash = StringField(required=True)
    security_question = StringField(max_length=255)  # NEW
    security_answer_hash = StringField()             # NEW
    # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
```

### –ù–æ–≤–∞—è –º–æ–¥–µ–ª—å PasswordResetCode
```python
class PasswordResetCode(Document):
    user = ReferenceField(User, required=True)
    reset_code = StringField(required=True, max_length=8)
    created_at = DateTimeField(default=datetime.utcnow)
    expires_at = DateTimeField(required=True)  # +15 –º–∏–Ω—É—Ç
    is_used = BooleanField(default=False)
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û—Ç–≤–µ—Ç—ã –Ω–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Ö—ç—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt (–∫–∞–∫ –∏ –ø–∞—Ä–æ–ª–∏)
2. **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–¥–æ–≤**: –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–¥—ã –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç
3. **–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –∫–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
5. **–ù–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç–∏—è**: API –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º email

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–±–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞) –¥–æ—Å—Ç—É–ø–Ω—ã:
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
- ‚úÖ –ê–¥–º–∏–Ω—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –º–æ–∂–Ω–æ:
1. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
2. –ü–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–∏–ª—å (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

## üé® Frontend (TODO)

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å:
1. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞)
2. –°—Ç—Ä–∞–Ω–∏—Ü—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è —Å –≤—ã–±–æ—Ä–æ–º –º–µ—Ç–æ–¥–∞
3. –§–æ—Ä–º—ã –¥–ª—è –≤–≤–æ–¥–∞ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ / –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

## üìö API Endpoints

| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| POST | `/api/auth/register/` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (—Ç–µ–ø–µ—Ä—å —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –≤–æ–ø—Ä–æ—Å–æ–º) |
| POST | `/api/auth/password-reset/request/` | –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ |
| POST | `/api/auth/password-reset/verify-security/` | –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å |
| POST | `/api/auth/password-reset/verify-code/` | –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ |

## ‚úÖ –ì–æ—Ç–æ–≤–æ

- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ API endpoints
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤
- ‚úÖ –í—ã–≤–æ–¥ –∫–æ–¥–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª—å
- ‚úÖ –ê–¥–º–∏–Ω—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
- ‚ùå Frontend —Ñ–æ—Ä–º—ã (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
